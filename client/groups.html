<template name="/groups">
	<div class="background"></div>
	<div class="document">
		{{> navbar class="navbar-default navbar-fixed-top hidden-xs"}}
		{{> navbar class="navbar-default opacity-0 hidden-xs"}}
		{{> navbar class="navbar-default visible-xs-block"}}
		<br><br>
	    <div class="container text-center">
	        <i class="fa fa-5x fa-fw fa-users"></i>
	        <h1>shuttler:groups</h1>
	        <p><small><kbd>meteor install shuttler:groups</kbd>@0.0.0</small></p>
	        <p><a href="https://github.com/meteor-shuttler/groups">GitHub</a> - <a href="atmospherejs.com/shuttler/groups">Atmosphere.js</a></p>
			<p>Collection of access-grouping nesting.</p>
	    </div>
		<div class="well well-sm">
			<div class="container text-center">
				Example of groups tree and users list. To edit was used jQuery-ui.
			</div>
		</div>
		<br><br>
	    <div class="container">
	    	<div class="col-sm-6">
	    		<h4>Groups {{> groupsInsertGroup}}</h4>
	    		<div class="well">
	    			{{> groupsGroups posts=posts}}
	    		</div>
	    	</div>
	    	<div class="col-sm-6">
	    		<h4>Users {{> groupsInsertUser}}</h4>
	    		<div class="well">
	    			{{> groupsUsers users=users}}
	    		</div>
	    	</div>
	    </div>
	</div>
</template>

<template name="groupsInsertGroup">
	<div class="btn btn-primary">
		<i class="fa fa-fw fa-plus"></i>
	</div>
</template>

<template name="groupsInsertUser">
	<div class="btn btn-primary">
		<i class="fa fa-fw fa-plus"></i>
	</div>
</template>

<template name="groupsGroups">
	<div class="list-group">
		{{#each posts}}
			{{> groupsGroup post=this}}
		{{/each}}
	</div>
</template>

<template name="groupsGroup">
	<div class="list-group-item">
		<div>
			<i class="fa fa-fw fa-users"></i>
			<div class="btn-group btn-group-xs">
				{{#Drop trigger="tooltip" direction="left"}}
					{{> groupsInsertGroup post}}
				{{else}}
					<div class="popover-content">
						Insert group
					</div>
				{{/Drop}}
				{{#Drop trigger="tooltip" direction="right"}}
					{{#quickRemoveButton collection=groupsGroupsCollection _id=post._id class="btn btn-primary"}}<i class="fa fa-fw fa-remove"></i>{{/quickRemoveButton}}
				{{else}}
					<div class="popover-content">
						Remove group
					</div>
				{{/Drop}}
			</div>
			{{post._id}}
			<div class="btn-group btn-group-xs pull-right">
				{{#Drop trigger="dropmenu"}}
					<div class="btn btn-primary">
						<i class="fa fa-fw fa-list"></i>
					</div>
				{{else}}
					<div class="popover-content">
						123
					</div>
				{{/Drop}}
			</div>
		</div>
		{{#if post.posts}}
			<div style="height: 5px;"></div>
		{{/if}}
		{{> groupsGroups posts=post.posts}}
		{{#if post.users}}
			<div style="height: 5px;"></div>
		{{/if}}
		{{> groupsUsers users=post.users post=post}}
	</div>
</template>

<template name="groupsUsers">
	<div class="list-group">
		{{#each users}}
			{{> groupsUser user=this post=../post}}
		{{/each}}
	</div>
</template>

<template name="groupsUser">
	<div class="list-group-item" data-shuttler-groups-user={{user._id}} style="{{#unless post}}cursor: move;{{/unless}}">
		<i class="fa fa-fw fa-user"></i>
		<div class="btn-group btn-group-xs">
			{{#if post}}
				{{#Drop trigger="tooltip" direction="right"}}
					<div class="btn btn-primary shuttler-groups-user-ungroup">
						<i class="fa fa-fw fa-chain-broken"></i>
					</div>
				{{else}}
					<div class="popover-content">
						Remove from group
					</div>
				{{/Drop}}
			{{else}}
				{{#Drop trigger="tooltip" direction="right"}}
					{{#quickRemoveButton collection=groupsUsersCollection _id=user._id class="btn btn-primary"}}<i class="fa fa-fw fa-remove"></i>{{/quickRemoveButton}}
				{{else}}
					<div class="popover-content">
						Remove user
					</div>
				{{/Drop}}
			{{/if}}
		</div>
		{{user._id}}
		<div class="btn-group btn-group-xs pull-right">
			{{#Drop trigger="dropmenu"}}
				<div class="btn btn-primary">
					<i class="fa fa-fw fa-list"></i>
				</div>
			{{else}}
				<div class="popover-content">
				    {{> ShuttlerGroupsUI indexes=groupsIndexes}}
				</div>
			{{/Drop}}
		</div>
	</div>
</template>